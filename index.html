<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eisenhower Matrix Task Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .task-card {
            transition: transform 0.2s, opacity 0.2s;
        }
        .task-card.dragging {
            opacity: 0.5;
            transform: scale(1.05);
        }
        .quadrant.highlight {
            background-color: rgba(59, 130, 246, 0.1);
            border: 2px dashed #3b82f6;
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .modal {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .modal.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center text-blue-600">Eisenhower Matrix</h1>
            <p class="text-center text-gray-600 mt-2">Organize your tasks by importance and urgency</p>
            
            <!-- Filter/Search Bar -->
            <div class="mt-6 flex flex-col md:flex-row gap-3">
                <div class="relative flex-grow">
                    <input type="text" id="search-input" placeholder="Search tasks..." 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                </div>
                <select id="category-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="">All Categories</option>
                </select>
                <button id="export-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                    <i class="fas fa-download mr-2"></i>Export
                </button>
                <button id="import-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                    <i class="fas fa-upload mr-2"></i>Import
                </button>
                <input type="file" id="import-file" class="hidden" accept=".json">
            </div>
        </header>

        <!-- Main Matrix Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="matrix-container">
            <!-- Quadrant 1: Important & Urgent -->
            <div class="quadrant bg-red-50 border border-red-200 rounded-lg p-4" data-quadrant="1">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-red-700">
                        <i class="fas fa-exclamation-circle mr-2"></i>Important & Urgent
                    </h2>
                    <button class="add-task-btn px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200" data-quadrant="1">
                        <i class="fas fa-plus mr-1"></i>Add Task
                    </button>
                </div>
                <div class="tasks-container min-h-[100px] space-y-3" id="quadrant-1-tasks"></div>
            </div>

            <!-- Quadrant 2: Important & Not Urgent -->
            <div class="quadrant bg-blue-50 border border-blue-200 rounded-lg p-4" data-quadrant="2">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-blue-700">
                        <i class="fas fa-check-circle mr-2"></i>Important & Not Urgent
                    </h2>
                    <button class="add-task-btn px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200" data-quadrant="2">
                        <i class="fas fa-plus mr-1"></i>Add Task
                    </button>
                </div>
                <div class="tasks-container min-h-[100px] space-y-3" id="quadrant-2-tasks"></div>
            </div>

            <!-- Quadrant 3: Not Important & Urgent -->
            <div class="quadrant bg-yellow-50 border border-yellow-200 rounded-lg p-4" data-quadrant="3">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-yellow-700">
                        <i class="fas fa-clock mr-2"></i>Not Important & Urgent
                    </h2>
                    <button class="add-task-btn px-3 py-1 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200" data-quadrant="3">
                        <i class="fas fa-plus mr-1"></i>Add Task
                    </button>
                </div>
                <div class="tasks-container min-h-[100px] space-y-3" id="quadrant-3-tasks"></div>
            </div>

            <!-- Quadrant 4: Not Important & Not Urgent -->
            <div class="quadrant bg-green-50 border border-green-200 rounded-lg p-4" data-quadrant="4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-green-700">
                        <i class="fas fa-times-circle mr-2"></i>Not Important & Not Urgent
                    </h2>
                    <button class="add-task-btn px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200" data-quadrant="4">
                        <i class="fas fa-plus mr-1"></i>Add Task
                    </button>
                </div>
                <div class="tasks-container min-h-[100px] space-y-3" id="quadrant-4-tasks"></div>
            </div>
        </div>

        <!-- Task Stats -->
        <div class="mt-6 bg-white p-4 rounded-lg shadow">
            <h3 class="font-bold mb-2">Task Statistics</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-red-50 p-3 rounded-lg">
                    <div class="text-red-700 font-bold text-xl" id="quadrant-1-count">0</div>
                    <div class="text-gray-600">Important & Urgent</div>
                </div>
                <div class="bg-blue-50 p-3 rounded-lg">
                    <div class="text-blue-700 font-bold text-xl" id="quadrant-2-count">0</div>
                    <div class="text-gray-600">Important & Not Urgent</div>
                </div>
                <div class="bg-yellow-50 p-3 rounded-lg">
                    <div class="text-yellow-700 font-bold text-xl" id="quadrant-3-count">0</div>
                    <div class="text-gray-600">Not Important & Urgent</div>
                </div>
                <div class="bg-green-50 p-3 rounded-lg">
                    <div class="text-green-700 font-bold text-xl" id="quadrant-4-count">0</div>
                    <div class="text-gray-600">Not Important & Not Urgent</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="task-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold" id="modal-title">Add New Task</h3>
                    <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="task-form">
                    <input type="hidden" id="task-id">
                    <input type="hidden" id="task-quadrant">
                    
                    <div class="mb-4">
                        <label for="task-title" class="block text-sm font-medium text-gray-700 mb-1">Title*</label>
                        <input type="text" id="task-title" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div class="mb-4">
                        <label for="task-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea id="task-description" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="task-due-date" class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
                            <input type="date" id="task-due-date"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        
                        <div>
                            <label for="task-priority" class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                            <select id="task-priority"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="task-category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <div class="flex">
                            <input type="text" id="task-category" list="categories-list"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <datalist id="categories-list"></datalist>
                            <button type="button" id="clear-category" class="px-3 bg-gray-100 border border-l-0 rounded-r-lg text-gray-600 hover:bg-gray-200">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-4" id="recurrence-section">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Recurrence</label>
                        <div class="flex items-center space-x-2">
                            <select id="task-recurrence"
                                    class="flex-grow px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">None</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button type="button" id="cancel-task" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            Save Task
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">Confirm Deletion</h3>
                    <button id="close-confirm-modal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <p class="mb-6">Are you sure you want to delete this task?</p>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancel-delete" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                        Cancel
                    </button>
                    <button type="button" id="confirm-delete" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Task Manager Application
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const matrixContainer = document.getElementById('matrix-container');
            const searchInput = document.getElementById('search-input');
            const categoryFilter = document.getElementById('category-filter');
            const exportBtn = document.getElementById('export-btn');
            const importBtn = document.getElementById('import-btn');
            const importFile = document.getElementById('import-file');
            const taskModal = document.getElementById('task-modal');
            const confirmModal = document.getElementById('confirm-modal');
            const taskForm = document.getElementById('task-form');
            const categoriesList = document.getElementById('categories-list');
            
            // State
            let tasks = [];
            let currentTaskId = null;
            let draggedTask = null;
            let searchTerm = '';
            let selectedCategory = '';
            
            // Initialize the app
            init();
            
            function init() {
                loadTasks();
                setupEventListeners();
                updateCategoryFilter();
            }
            
            function setupEventListeners() {
                // Search and filter
                searchInput.addEventListener('input', function() {
                    searchTerm = this.value.toLowerCase();
                    filterTasks();
                });
                
                categoryFilter.addEventListener('change', function() {
                    selectedCategory = this.value;
                    filterTasks();
                });
                
                // Import/Export
                exportBtn.addEventListener('click', exportTasks);
                importBtn.addEventListener('click', () => importFile.click());
                importFile.addEventListener('change', importTasks);
                
                // Task modal
                document.querySelectorAll('.add-task-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const quadrant = this.getAttribute('data-quadrant');
                        openTaskModal(null, quadrant);
                    });
                });
                
                document.getElementById('close-modal').addEventListener('click', closeTaskModal);
                document.getElementById('cancel-task').addEventListener('click', closeTaskModal);
                taskForm.addEventListener('submit', saveTask);
                
                // Confirm modal
                document.getElementById('close-confirm-modal').addEventListener('click', closeConfirmModal);
                document.getElementById('cancel-delete').addEventListener('click', closeConfirmModal);
                document.getElementById('confirm-delete').addEventListener('click', deleteTaskConfirmed);
                
                // Clear category button
                document.getElementById('clear-category').addEventListener('click', function() {
                    document.getElementById('task-category').value = '';
                });
                
                // Drag and drop setup
                setupDragAndDrop();
            }
            
            // Task CRUD Operations
            function loadTasks() {
                const savedTasks = localStorage.getItem('eisenhower-tasks');
                if (savedTasks) {
                    tasks = JSON.parse(savedTasks);
                    renderTasks();
                    updateStats();
                    updateCategoryFilter();
                }
            }
            
            function saveTasks() {
                localStorage.setItem('eisenhower-tasks', JSON.stringify(tasks));
                updateStats();
                updateCategoryFilter();
            }
            
            function addTask(task) {
                tasks.push(task);
                saveTasks();
                renderTasks();
            }
            
            function updateTask(id, updates) {
                const taskIndex = tasks.findIndex(t => t.id === id);
                if (taskIndex !== -1) {
                    tasks[taskIndex] = { ...tasks[taskIndex], ...updates };
                    saveTasks();
                    renderTasks();
                }
            }
            
            function deleteTask(id) {
                tasks = tasks.filter(t => t.id !== id);
                saveTasks();
                renderTasks();
            }
            
            // Task Modal Functions
            function openTaskModal(task = null, quadrant = null) {
                const modalTitle = document.getElementById('modal-title');
                const taskIdInput = document.getElementById('task-id');
                const taskQuadrantInput = document.getElementById('task-quadrant');
                const taskTitleInput = document.getElementById('task-title');
                const taskDescriptionInput = document.getElementById('task-description');
                const taskDueDateInput = document.getElementById('task-due-date');
                const taskPriorityInput = document.getElementById('task-priority');
                const taskCategoryInput = document.getElementById('task-category');
                const taskRecurrenceInput = document.getElementById('task-recurrence');
                
                if (task) {
                    // Edit existing task
                    modalTitle.textContent = 'Edit Task';
                    currentTaskId = task.id;
                    taskIdInput.value = task.id;
                    taskQuadrantInput.value = task.quadrant;
                    taskTitleInput.value = task.title;
                    taskDescriptionInput.value = task.description || '';
                    taskDueDateInput.value = task.dueDate || '';
                    taskPriorityInput.value = task.priority || 'medium';
                    taskCategoryInput.value = task.category || '';
                    taskRecurrenceInput.value = task.recurrence || '';
                } else {
                    // Add new task
                    modalTitle.textContent = 'Add New Task';
                    currentTaskId = null;
                    taskIdInput.value = '';
                    taskQuadrantInput.value = quadrant;
                    taskTitleInput.value = '';
                    taskDescriptionInput.value = '';
                    
                    // Set default due date to today
                    const today = new Date();
                    const formattedDate = today.toISOString().split('T')[0];
                    taskDueDateInput.value = formattedDate;
                    
                    taskPriorityInput.value = 'medium';
                    taskCategoryInput.value = '';
                    taskRecurrenceInput.value = '';
                }
                
                taskModal.classList.remove('hidden');
            }
            
            function closeTaskModal() {
                taskModal.classList.add('hidden');
                taskForm.reset();
            }
            
            function saveTask(e) {
                e.preventDefault();
                
                const taskId = document.getElementById('task-id').value;
                const quadrant = document.getElementById('task-quadrant').value;
                const title = document.getElementById('task-title').value.trim();
                const description = document.getElementById('task-description').value.trim();
                const dueDate = document.getElementById('task-due-date').value;
                const priority = document.getElementById('task-priority').value;
                const category = document.getElementById('task-category').value.trim();
                const recurrence = document.getElementById('task-recurrence').value;
                
                if (!title) {
                    alert('Please enter a task title');
                    return;
                }
                
                const taskData = {
                    id: taskId || generateId(),
                    title,
                    description: description || null,
                    dueDate: dueDate || null,
                    priority,
                    category: category || null,
                    recurrence: recurrence || null,
                    quadrant: parseInt(quadrant),
                    createdAt: new Date().toISOString()
                };
                
                // Calculate quadrant if not specified (for new tasks)
                if (!quadrant) {
                    taskData.quadrant = calculateQuadrant(priority, dueDate);
                }
                
                if (taskId) {
                    updateTask(taskId, taskData);
                } else {
                    addTask(taskData);
                }
                
                closeTaskModal();
            }
            
            function openConfirmModal(taskId) {
                currentTaskId = taskId;
                confirmModal.classList.remove('hidden');
            }
            
            function closeConfirmModal() {
                confirmModal.classList.add('hidden');
            }
            
            function deleteTaskConfirmed() {
                if (currentTaskId) {
                    deleteTask(currentTaskId);
                    closeConfirmModal();
                }
            }
            
            // Task Rendering
            function renderTasks() {
                // Clear all quadrants
                for (let i = 1; i <= 4; i++) {
                    const container = document.getElementById(`quadrant-${i}-tasks`);
                    container.innerHTML = '';
                }
                
                // Filter tasks based on search and category
                const filteredTasks = tasks.filter(task => {
                    const matchesSearch = searchTerm === '' || 
                        task.title.toLowerCase().includes(searchTerm) || 
                        (task.description && task.description.toLowerCase().includes(searchTerm));
                    
                    const matchesCategory = selectedCategory === '' || 
                        (task.category && task.category === selectedCategory);
                    
                    return matchesSearch && matchesCategory;
                });
                
                // Render each task in its quadrant
                filteredTasks.forEach(task => {
                    const container = document.getElementById(`quadrant-${task.quadrant}-tasks`);
                    if (container) {
                        container.appendChild(createTaskCard(task));
                    }
                });
                
                // Show empty state if no tasks in a quadrant
                for (let i = 1; i <= 4; i++) {
                    const container = document.getElementById(`quadrant-${i}-tasks`);
                    if (container.children.length === 0) {
                        const emptyMsg = document.createElement('div');
                        emptyMsg.className = 'text-center text-gray-500 py-4';
                        emptyMsg.textContent = '(No tasks)';
                        container.appendChild(emptyMsg);
                    }
                }
            }
            
            function createTaskCard(task) {
                const card = document.createElement('div');
                card.className = `task-card bg-white rounded-lg shadow p-3 border-l-4 cursor-move`;
                card.setAttribute('draggable', 'true');
                card.setAttribute('data-task-id', task.id);
                
                // Set border color based on priority
                if (task.priority === 'high') {
                    card.classList.add('border-l-red-500');
                } else if (task.priority === 'medium') {
                    card.classList.add('border-l-orange-500');
                } else {
                    card.classList.add('border-l-green-500');
                }
                
                // Task content
                let html = `
                    <div class="flex justify-between items-start">
                        <div class="flex-grow">
                            <div class="font-medium">${task.title}</div>
                            ${task.description ? `<div class="text-sm text-gray-600 mt-1 line-clamp-2">${task.description}</div>` : ''}
                        </div>
                        <div class="flex space-x-2 ml-2">
                            <button class="edit-task text-blue-500 hover:text-blue-700" data-task-id="${task.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-task text-red-500 hover:text-red-700" data-task-id="${task.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // Bottom row with metadata
                html += `<div class="flex justify-between items-center mt-2 text-xs text-gray-500">`;
                
                // Due date
                if (task.dueDate) {
                    const dueDate = new Date(task.dueDate);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    let dateClass = '';
                    if (dueDate < today) {
                        dateClass = 'text-red-500';
                    } else if (dueDate.getTime() === today.getTime()) {
                        dateClass = 'text-yellow-600';
                    }
                    
                    html += `<div class="${dateClass}">
                        <i class="far fa-calendar-alt mr-1"></i>${formatDate(dueDate)}
                    </div>`;
                } else {
                    html += `<div></div>`;
                }
                
                // Category and recurrence
                html += `<div class="flex items-center space-x-2">`;
                if (task.category) {
                    html += `<span class="bg-gray-100 px-2 py-1 rounded">${task.category}</span>`;
                }
                if (task.recurrence) {
                    html += `<span class="text-blue-500">
                        <i class="fas fa-sync-alt"></i>
                    </span>`;
                }
                html += `</div>`;
                
                html += `</div>`;
                
                card.innerHTML = html;
                
                // Add event listeners for edit and delete
                card.querySelector('.edit-task').addEventListener('click', function() {
                    const taskId = this.getAttribute('data-task-id');
                    const task = tasks.find(t => t.id === taskId);
                    if (task) {
                        openTaskModal(task);
                    }
                });
                
                card.querySelector('.delete-task').addEventListener('click', function() {
                    const taskId = this.getAttribute('data-task-id');
                    openConfirmModal(taskId);
                });
                
                return card;
            }
            
            function filterTasks() {
                renderTasks();
            }
            
            function updateStats() {
                for (let i = 1; i <= 4; i++) {
                    const count = tasks.filter(t => t.quadrant === i).length;
                    document.getElementById(`quadrant-${i}-count`).textContent = count;
                }
            }
            
            function updateCategoryFilter() {
                // Get all unique categories from tasks
                const categories = new Set();
                tasks.forEach(task => {
                    if (task.category) {
                        categories.add(task.category);
                    }
                });
                
                // Update category filter dropdown
                categoryFilter.innerHTML = `
                    <option value="">All Categories</option>
                    ${Array.from(categories).map(cat => `<option value="${cat}">${cat}</option>`).join('')}
                `;
                
                // Update datalist for category suggestions
                categoriesList.innerHTML = Array.from(categories).map(cat => 
                    `<option value="${cat}">${cat}</option>`
                ).join('');
            }
            
            // Import/Export
            function exportTasks() {
                const dataStr = JSON.stringify(tasks, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `eisenhower-tasks-${formatDate(new Date(), 'YYYY-MM-DD')}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            }
            
            function importTasks(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedTasks = JSON.parse(e.target.result);
                        if (Array.isArray(importedTasks)) {
                            // Merge with existing tasks, keeping existing ones if IDs match
                            const existingIds = tasks.map(t => t.id);
                            const newTasks = importedTasks.filter(t => !existingIds.includes(t.id));
                            
                            tasks = [...tasks, ...newTasks];
                            saveTasks();
                            renderTasks();
                            
                            alert(`Successfully imported ${newTasks.length} tasks`);
                        } else {
                            alert('Invalid file format: Expected an array of tasks');
                        }
                    } catch (error) {
                        alert('Error parsing JSON file: ' + error.message);
                    }
                };
                reader.readAsText(file);
                importFile.value = ''; // Reset file input
            }
            
            // Drag and Drop
            function setupDragAndDrop() {
                // Add event listeners to all task cards
                matrixContainer.addEventListener('dragstart', function(e) {
                    if (e.target.classList.contains('task-card')) {
                        draggedTask = e.target;
                        e.target.classList.add('dragging');
                        e.dataTransfer.setData('text/plain', e.target.getAttribute('data-task-id'));
                        e.dataTransfer.effectAllowed = 'move';
                    }
                });
                
                matrixContainer.addEventListener('dragend', function(e) {
                    if (e.target.classList.contains('task-card')) {
                        e.target.classList.remove('dragging');
                        draggedTask = null;
                    }
                });
                
                // Handle drag over quadrants
                document.querySelectorAll('.quadrant').forEach(quadrant => {
                    quadrant.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';
                        this.classList.add('highlight');
                    });
                    
                    quadrant.addEventListener('dragleave', function() {
                        this.classList.remove('highlight');
                    });
                    
                    quadrant.addEventListener('drop', function(e) {
                        e.preventDefault();
                        this.classList.remove('highlight');
                        
                        if (draggedTask) {
                            const taskId = e.dataTransfer.getData('text/plain');
                            const newQuadrant = parseInt(this.getAttribute('data-quadrant'));
                            
                            // Find the task and update its quadrant
                            const task = tasks.find(t => t.id === taskId);
                            if (task && task.quadrant !== newQuadrant) {
                                updateTask(taskId, { quadrant: newQuadrant });
                            }
                        }
                    });
                });
            }
            
            // Helper Functions
            function generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }
            
            function calculateQuadrant(priority, dueDate) {
                const isImportant = priority === 'high' || priority === 'medium';
                const isUrgent = isTaskUrgent(dueDate);
                
                if (isImportant && isUrgent) return 1;
                if (isImportant && !isUrgent) return 2;
                if (!isImportant && isUrgent) return 3;
                return 4;
            }
            
            function isTaskUrgent(dueDate) {
                if (!dueDate) return false;
                
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const taskDate = new Date(dueDate);
                taskDate.setHours(0, 0, 0, 0);
                
                // Urgent if due today or overdue
                return taskDate <= today || 
                    (taskDate.getTime() - today.getTime()) <= 24 * 60 * 60 * 1000; // Within 24 hours
            }
            
            function formatDate(date, format = 'YYYY-MM-DD') {
                if (!date) return '';
                
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                
                return format
                    .replace('YYYY', year)
                    .replace('MM', month)
                    .replace('DD', day);
            }
        });
    </script>
</body>
</html>